<form [formGroup]="filtersForm">
  <div class="filters-scrollable-content">
    <!-- TÍTULO PRINCIPAL DE FILTROS -->
    <h1 class="main-filters-title">
      <i class="pi pi-filter"></i>
      {{ texts.mainTitle }}
    </h1>

    <!-- SECCIÓN DE CERTIFICADOS - DESTACADA AL INICIO -->
    <div class="certificates-highlight-section">
      <div class="certificates-header">
        <i class="pi pi-certificate"></i>
        <h2 class="certificates-title">{{ texts.certificatesLabel }}</h2>
      </div>
      <p class="certificates-description">
        {{ texts.certificatesDescription }}
      </p>
      <div class="certificates-premium">
        <button
          type="button"
          class="certificate-card"
          [class.active]="isCertificateSelected('emotional')"
          (click)="toggleCertificate('emotional')"
        >
          <div class="certificate-icon">
            <i class="pi pi-heart"></i>
          </div>
          <div class="certificate-content">
            <h3 class="certificate-name">{{ texts.emotionalSupport }}</h3>
            <p class="certificate-desc">{{ texts.emotionalSupportDescription }}</p>
            <span class="certificate-badge">AE</span>
          </div>
        </button>
        <button
          type="button"
          class="certificate-card"
          [class.active]="isCertificateSelected('service')"
          (click)="toggleCertificate('service')"
        >
          <div class="certificate-icon">
            <i class="pi pi-shield"></i>
          </div>
          <div class="certificate-content">
            <h3 class="certificate-name">{{ texts.serviceAnimal }}</h3>
            <p class="certificate-desc">{{ texts.serviceAnimalDescription }}</p>
            <span class="certificate-badge">PS</span>
          </div>
        </button>
      </div>
    </div>

    <h2 class="filters-title">
      <i class="pi pi-paw"></i>
      {{ texts.petDetailsTitle }}
    </h2>

    <div class="filter-section">
      <label class="filter-label">{{ texts.petTypeLabel }}</label>
      <div class="pet-type-buttons">
        <button
          type="button"
          class="pet-type-btn"
          [class.active]="selectedPetType === 'dog'"
          (click)="selectPetType('dog')"
        >
          <span>{{ texts.dogLabel }}</span>
        </button>
        <button
          type="button"
          class="pet-type-btn"
          [class.active]="selectedPetType === 'cat'"
          (click)="selectPetType('cat')"
        >
          <span>{{ texts.catLabel }}</span>
        </button>
      </div>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.breedLabel }}</label>
      <petfly-input-select
        formControlName="razaMascota"
        [options]="razasOptions"
        [placeholder]="isLoadingBreeds ? texts.loadingBreeds : texts.breedPlaceholder"
        [filter]="true"
      >
      </petfly-input-select>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.petAgeLabel }}</label>
      <p class="filter-subtitle">{{ texts.petAgeSubtitle }}</p>
      <petfly-input-number formControlName="edadMascota" [min]="0" [max]="30" [step]="1">
      </petfly-input-number>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.petWeightLabel }}</label>
      <p class="filter-subtitle">{{ texts.petWeightSubtitle }}</p>
      <petfly-input-number
        formControlName="pesoMascota"
        [min]="0.5"
        [max]="50"
        [step]="0.5"
        [placeholder]="texts.weightPlaceholder"
      >
      </petfly-input-number>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.noCarrierLabel }}</label>
      <div class="pet-type-buttons">
        <button
          type="button"
          class="pet-type-btn"
          [class.active]="filtersForm.get('sinTransportador')?.value === true"
          (click)="filtersForm.patchValue({ sinTransportador: true })"
        >
          <span>{{ texts.yesLabel }}</span>
        </button>
        <button
          type="button"
          class="pet-type-btn"
          [class.active]="filtersForm.get('sinTransportador')?.value === false"
          (click)="filtersForm.patchValue({ sinTransportador: false })"
        >
          <span>{{ texts.noLabel }}</span>
        </button>
      </div>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.dimensionsLabel }}</label>
      <div class="dimensions-grid">
        <petfly-input-number
          formControlName="length"
          [min]="0"
          [step]="1"
          [placeholder]="texts.minPricePlaceholder"
        >
        </petfly-input-number>
        <petfly-input-number
          formControlName="width"
          [min]="0"
          [step]="1"
          [placeholder]="texts.minPricePlaceholder"
        >
        </petfly-input-number>
        <petfly-input-number
          formControlName="height"
          [min]="0"
          [step]="1"
          [placeholder]="texts.minPricePlaceholder"
        >
        </petfly-input-number>
      </div>
      <div class="dimensions-labels-row">
        <span class="dimension-field-label">{{ texts.lengthLabel }}</span>
        <span class="dimension-field-label">{{ texts.widthLabel }}</span>
        <span class="dimension-field-label">{{ texts.heightLabel }}</span>
      </div>
    </div>

    <h2 class="filters-title">
      <i class="pi pi-plane"></i>
      {{ texts.travelDetailsTitle }}
    </h2>

    <div class="filter-section">
      <label class="filter-label">{{ texts.routeLabel }}</label>
      <div class="route-grid">
        <petfly-input-autocomplete
          formControlName="origen"
          [suggestions]="ciudadesOrigenOptions"
          (completeMethod)="onOrigenSearch($event)"
          (selectionChange)="onOrigenSelect($event)"
          field="label"
          [placeholder]="isLoadingCitiesOrigen ? texts.searchingCities : texts.originLabel"
          [forceSelection]="true"
          optionValue="value"
          [minLength]="2"
          [delay]="300"
          styleClass="search-input"
        >
        </petfly-input-autocomplete>
        <petfly-input-autocomplete
          formControlName="destino"
          [suggestions]="ciudadesDestinoOptions"
          (completeMethod)="onDestinoSearch($event)"
          (selectionChange)="onDestinoSelect($event)"
          field="label"
          [placeholder]="isLoadingCitiesDestino ? texts.searchingCities : texts.destinationLabel"
          [forceSelection]="true"
          optionValue="value"
          [minLength]="2"
          [delay]="300"
          styleClass="search-input"
        >
        </petfly-input-autocomplete>
      </div>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.datesLabel }}</label>
      <div class="dates-grid">
        <petfly-input-calendar
          formControlName="fechaSalida"
          [placeholder]="texts.departureDateLabel"
          [showIcon]="true"
          iconDisplay="button"
          dateFormat="dd/mm/yy"
          [minDate]="today"
          styleClass="search-input"
        >
        </petfly-input-calendar>
        <petfly-input-calendar
          formControlName="fechaRegreso"
          [placeholder]="texts.returnDateLabel"
          [showIcon]="true"
          iconDisplay="button"
          dateFormat="dd/mm/yy"
          [minDate]="getMinReturnDate()"
          styleClass="search-input"
        >
        </petfly-input-calendar>
      </div>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.passengerAndCabinClassLabel }}</label>
      <petfly-passenger-selector
        formControlName="pasajeros"
        [placeholder]="texts.passengerLabel"
        [adultsLabel]="texts.adultsLabel"
        [adultsSubLabel]="texts.adultsSubLabel"
        [childrenLabel]="texts.childrenLabel"
        [childrenSubLabel]="texts.childrenSubLabel"
        [classLabel]="texts.cabinClassLabel"
        [economyLabel]="texts.economyClass"
        [businessLabel]="texts.businessClass"
        [passengerLabel]="texts.passengerSingular"
        [passengersLabel]="texts.passengerPlural"
        [cancelLabel]="texts.cancelLabel"
        [saveLabel]="texts.saveLabel"
      >
      </petfly-passenger-selector>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.airlinesStopsLabel }}</label>
      <div class="stops-options">
        <button
          type="button"
          class="stop-btn"
          [class.active]="filtersForm.get('permitirEscalas')?.value === true"
          (click)="filtersForm.patchValue({ permitirEscalas: true })"
        >
          {{ texts.allowStops }}
        </button>
        <button
          type="button"
          class="stop-btn"
          [class.active]="filtersForm.get('permitirEscalas')?.value === false"
          (click)="filtersForm.patchValue({ permitirEscalas: false })"
        >
          {{ texts.noStops }}
        </button>
      </div>
    </div>

    <h2 class="filters-title">
      {{ texts.priceLabel }}
    </h2>

    <div class="filter-section">
      <label class="filter-label">{{ texts.minPriceLabel }}</label>
      <petfly-input-number
        formControlName="precioMinimo"
        [min]="0"
        [step]="1000"
        [placeholder]="texts.minPricePlaceholder"
        prefix="$"
      >
      </petfly-input-number>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.maxPriceLabel }}</label>
      <petfly-input-number
        formControlName="precioMaximo"
        [min]="0"
        [step]="1000"
        [placeholder]="texts.maxPricePlaceholder"
        prefix="$"
      >
      </petfly-input-number>
    </div>

    <div class="filter-section">
      <label class="filter-label">{{ texts.airlinesLabel }}</label>
      <petfly-input-select
        formControlName="aerolinea"
        [options]="airlinesOptions"
        [placeholder]="texts.airlinesPlaceholder"
        [filter]="true"
        [showClear]="true"
      >
      </petfly-input-select>
    </div>
  </div>

  <!-- Botón de filtrar siempre visible (sticky) -->
  <div class="filters-footer">
    <button type="button" class="filter-button" (click)="onUpdateFilters()">
      <i class="pi pi-search"></i>
      <span>{{ texts.filterButton }}</span>
    </button>
  </div>
</form>
